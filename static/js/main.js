var App=(function(){'use strict';var config={assetsPath:'assets',imgPath:'img',jsPath:'js',libsPath:'lib',leftSidebarSlideSpeed:200,leftSidebarToggleSpeed:300,enableSwipe:true,swipeTreshold:100,scrollTop:true,openRightSidebarClass:'open-right-sidebar',openLeftSidebarClass:'open-left-sidebar',offCanvasLeftSidebarClass:'be-offcanvas-menu',toggleLeftSidebarButton:$('.be-toggle-left-sidebar'),closeRsOnClickOutside:true,removeLeftSidebarClass:'be-nosidebar-left',collapsibleSidebarClass:'be-collapsible-sidebar',collapsibleSidebarCollapsedClass:'be-collapsible-sidebar-collapsed',openLeftSidebarOnClick:true,transitionClass:'be-animate',openSidebarDelay:400};var colors={};var body=$("body");var wrapper=$(".be-wrapper");var leftSidebar=$(".be-left-sidebar");var rightSidebar=$(".be-right-sidebar");var openSidebar=false;function getColor(c){var tmp=$("<div>",{class:c}).appendTo("body");var color=tmp.css("background-color");tmp.remove();return color;}function leftSidebarInit(){var firstAnchor=$(".sidebar-elements > li > a",leftSidebar);var anchor=$(".sidebar-elements li a",leftSidebar);var lsc=$(".left-sidebar-scroll",leftSidebar);var lsToggle=$(".left-sidebar-toggle",leftSidebar);var openLeftSidebarOnClick=config.openLeftSidebarOnClick?true:false;function updateScroller(){if(wrapper.hasClass("be-fixed-sidebar")){lsc.perfectScrollbar('update');}}function toggleSideBar(){var button=$(".be-toggle-left-sidebar");button.on("click",function(){if(wrapper.hasClass(config.collapsibleSidebarCollapsedClass)){wrapper.removeClass(config.collapsibleSidebarCollapsedClass);$("li.open",leftSidebar).removeClass("open");$("li.active",leftSidebar).parents(".parent").addClass("active open");$(".be-scroller",leftSidebar).perfectScrollbar("destroy");}else{wrapper.addClass(config.collapsibleSidebarCollapsedClass);$("li.active",leftSidebar).parents(".parent").removeClass("open");$("li.open",leftSidebar).removeClass("open");}});}function syncSubMenu(item){var elements;if(typeof item!=="undefined"){elements=item;}else{elements=$(".sidebar-elements > li",leftSidebar);}$.each(elements,function(){var title=$(this).find("> a span").html();var ul=$(this).find("> ul");var subEls=$("> li",ul);title=$('<li class="title">'+title+'</li>');var subContainer=$('<li class="nav-items"><div class="be-scroller"><div class="content"><ul></ul></div></div></li>');if(!ul.find("> li.title").length){ul.prepend(title);subEls.appendTo(subContainer.find(".content ul"));subContainer.appendTo(ul);}});}function isCollapsed(){return wrapper.hasClass(config.collapsibleSidebarCollapsedClass);}function isCollapsible(){return wrapper.hasClass(config.collapsibleSidebarClass);}function closeSubMenu(subMenu,event){var target=$(event.currentTarget);var li=$(subMenu).parent();var openChildren=$('li.open',li);var clickOutside=!target.closest(leftSidebar).length;var slideSpeed=config.leftSidebarSlideSpeed;var isFirstLevel=target.parents().eq(1).hasClass('sidebar-elements');if(!$.isSm()&&isCollapsed()&&(isFirstLevel||clickOutside)){li.removeClass('open');subMenu.removeClass('visible');openChildren.removeClass('open').removeAttr('style');}else{subMenu.slideUp({duration:slideSpeed,complete:function(){li.removeClass('open');$(this).removeAttr('style');openChildren.removeClass('open').removeAttr('style');updateScroller();}});}}function openSubMenu(anchor,event){var _el=$(anchor);var li=$(_el).parent();var subMenu=$(_el).next();var slideSpeed=config.leftSidebarSlideSpeed;var isFirstLevel=$(event.currentTarget).parents().eq(1).hasClass('sidebar-elements');var openSubMenus=li.siblings('.open');if(openSubMenus){closeSubMenu($('> ul',openSubMenus),event);}if(!$.isSm()&&isCollapsed()&&isFirstLevel){var subMenuScroller=li.find('.be-scroller');li.addClass('open');subMenu.addClass('visible');subMenuScroller.perfectScrollbar('destroy');subMenuScroller.perfectScrollbar();}else{subMenu.slideDown({duration:slideSpeed,complete:function(){li.addClass('open');$(this).removeAttr('style');updateScroller();}});}}if(isCollapsible()){syncSubMenu();toggleSideBar();if(!openLeftSidebarOnClick){firstAnchor.on('mouseover',function(event){if(isCollapsed()){openSubMenu(this,event);}});firstAnchor.on('touchstart',function(event){var anchor=$(this);var li=anchor.parent();var subMenu=anchor.next();if(isCollapsed()&&!$.isSm()){if(li.hasClass('open')){closeSubMenu(subMenu,event);}else{openSubMenu(this,event);}if($(this).next().is('ul')){event.preventDefault();}}});firstAnchor.on('mouseleave',function(event){var _self=$(this);var _li=_self.parent();var subMenu=_li.find('> ul');if(!$.isSm()&&isCollapsed()){if(subMenu.length>0){setTimeout(function(){if(subMenu.is(':hover')){subMenu.on('mouseleave',function(){setTimeout(function(){if(!_self.is(':hover')){closeSubMenu(subMenu,event);subMenu.off('mouseleave');}},300);});}else{closeSubMenu(subMenu,event);}},300);}else{_li.removeClass('open');}}});}$(document).on("mousedown touchstart",function(event){if(!$(event.target).closest(leftSidebar).length&&!$.isSm()){closeSubMenu($("ul.visible",leftSidebar),event);}});}anchor.on("click",function(event){var $el=$(this),$open;var $li=$el.parent();var $subMenu=$el.next();var isFirstLevel=$el.parents().eq(1).hasClass('sidebar-elements');$open=$li.siblings(".open");if($li.hasClass('open')){closeSubMenu($subMenu,event);}else{openSubMenu(this,event);}if($el.next().is('ul')){event.preventDefault();}});if(wrapper.hasClass(config.collapsibleSidebarCollapsedClass)){$("li.active",leftSidebar).parents(".parent").addClass("active");}else{$("li.active",leftSidebar).parents(".parent").addClass("active open");}if(wrapper.hasClass("be-fixed-sidebar")){if(!$.isSm()||wrapper.hasClass(config.offCanvasLeftSidebarClass)){lsc.perfectScrollbar();}$(window).resize(function(){waitForFinalEvent(function(){if($.isSm()&&!wrapper.hasClass(config.offCanvasLeftSidebarClass)){lsc.perfectScrollbar('destroy');}else{if(lsc.hasClass('ps-container')){lsc.perfectScrollbar('update');}else{lsc.perfectScrollbar();}}},500,"be_update_scroller");});}lsToggle.on('click',function(e){var spacer=$(this).next('.left-sidebar-spacer'),toggleBtn=$(this);toggleBtn.toggleClass('open');spacer.slideToggle(config.leftSidebarToggleSpeed,function(){$(this).removeAttr('style').toggleClass('open');});});function leftSidebarOffCanvas(){config.toggleLeftSidebarButton.on("click",function(e){if(openSidebar&&body.hasClass(config.openLeftSidebarClass)){body.removeClass(config.openLeftSidebarClass);sidebarDelay();}else{body.addClass(config.openLeftSidebarClass+" "+config.transitionClass);openSidebar=true;}e.preventDefault();});$(document).on("mousedown touchstart",function(e){if(!$(e.target).closest(leftSidebar).length&&!$(e.target).closest(config.toggleLeftSidebarButton).length&&body.hasClass(config.openLeftSidebarClass)){body.removeClass(config.openLeftSidebarClass);sidebarDelay();}});}if(wrapper.hasClass(config.offCanvasLeftSidebarClass)){leftSidebarOffCanvas();}}function rightSidebarInit(){var rsScrollbar=$(".be-scroller",rightSidebar);function oSidebar(){body.addClass(config.openRightSidebarClass+" "+config.transitionClass);openSidebar=true;}function cSidebar(){body.removeClass(config.openRightSidebarClass).addClass(config.transitionClass);sidebarDelay();}if(rightSidebar.length>0){$('.be-toggle-right-sidebar').on("click",function(e){if(openSidebar&&body.hasClass(config.openRightSidebarClass)){cSidebar();}else if(!openSidebar){oSidebar();}e.preventDefault();});$(document).on("mousedown touchstart",function(e){if(!$(e.target).closest(rightSidebar).length&&body.hasClass(config.openRightSidebarClass)&&(config.closeRsOnClickOutside||$.isSm())){cSidebar();}});}rsScrollbar.perfectScrollbar();$(window).resize(function(){waitForFinalEvent(function(){rsScrollbar.perfectScrollbar('update');},500,"be_rs_update_scroller");});$('a[data-toggle="tab"]',rightSidebar).on('shown.bs.tab',function(e){var scrollEl=$(e.target.getAttribute("href")).find('.be-scroller');if(scrollEl.length){scrollEl.perfectScrollbar('update');}});}function sidebarDelay(){openSidebar=true;setTimeout(function(){openSidebar=false;},config.openSidebarDelay);}function sidebarSwipe(){wrapper.swipe({allowPageScroll:"vertical",preventDefaultEvents:false,fallbackToMouseEvents:false,swipeLeft:function(e){if(!openSidebar&&rightSidebar.length>0){body.addClass(config.openRightSidebarClass+" "+config.transitionClass);openSidebar=true;}},threshold:config.swipeTreshold});}function chatWidget(){var chat=$(".be-right-sidebar .tab-chat");var contactsEl=$(".chat-contacts",chat);var conversationEl=$(".chat-window",chat);var messagesContainer=$(".chat-messages",conversationEl);var messagesList=$(".content ul",messagesContainer);var messagesScroll=$(".be-scroller",messagesContainer);var chatInputContainer=$(".chat-input",conversationEl);var chatInput=$("input",chatInputContainer);var chatInputSendButton=$(".send-msg",chatInputContainer);function openChatWindow(){if(!chat.hasClass("chat-opened")){chat.addClass("chat-opened");}}function closeChatWindow(){if(chat.hasClass("chat-opened")){chat.removeClass("chat-opened");}}$(".user a",contactsEl).on('click',function(e){openChatWindow();e.preventDefault();});$(".title .return",conversationEl).on('click',function(e){closeChatWindow();scrollerInit();});function sendMsg(msg,self){var $message=$('<li class="'+((self)?'self':'friend')+'"></li>');if(msg!=''){$('<div class="msg">'+msg+'</div>').appendTo($message);$message.appendTo(messagesList);messagesScroll.stop().animate({'scrollTop':messagesScroll.prop("scrollHeight")},900,'swing');messagesScroll.perfectScrollbar('update');}}chatInput.keypress(function(event){var keycode=(event.keyCode?event.keyCode:event.which);var msg=$(this).val();if(keycode=='13'){sendMsg(msg,true);$(this).val("");}event.stopPropagation();});chatInputSendButton.on('click',function(){var msg=chatInput.val();sendMsg(msg,true);chatInput.val("");});}function scrollerInit(){$(".be-scroller").perfectScrollbar();}function scrollTopButton(){var offset=220;var duration=500;var button=$('<div class="be-scroll-top"></div>');button.appendTo("body");$(window).on('scroll',function(){if($(this).scrollTop()>offset){button.fadeIn(duration);}else{button.fadeOut(duration);}});button.on('touchstart mouseup',function(e){$('html, body').animate({scrollTop:0},duration);e.preventDefault();});}var waitForFinalEvent=(function(){var timers={};return function(callback,ms,uniqueId){if(!uniqueId){uniqueId="x1x2x3x4";}if(timers[uniqueId]){clearTimeout(timers[uniqueId]);}timers[uniqueId]=setTimeout(callback,ms);};})();return{conf:config,color:colors,init:function(options){$.extend(config,options);FastClick.attach(document.body);leftSidebarInit();rightSidebarInit();chatWidget();if(config.enableSwipe){sidebarSwipe();}if(config.scrollTop){scrollTopButton();}colors.primary=getColor('clr-primary');colors.success=getColor('clr-success');colors.warning=getColor('clr-warning');colors.danger=getColor('clr-danger');colors.grey=getColor('clr-grey');$(".be-connections").on("click",function(e){e.stopPropagation();});scrollerInit();$('.dropdown').on('shown.bs.dropdown',function(){$(".be-scroller").perfectScrollbar('update');});$('.nav-tabs').on('shown.bs.tab',function(e){$(".be-scroller").perfectScrollbar('update');});$('[data-toggle="tooltip"]').tooltip();$('[data-toggle="popover"]').popover();$('.modal').on('show.bs.modal',function(){$("html").addClass('be-modal-open');});$('.modal').on('hidden.bs.modal',function(){$("html").removeClass('be-modal-open');});}};})();